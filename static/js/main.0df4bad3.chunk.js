(this["webpackJsonpogg-opus-viz"]=this["webpackJsonpogg-opus-viz"]||[]).push([[0],{12:function(e,t,n){},30:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);var r,i=n(1),a=n.n(i),c=n(17),o=n.n(c),s=(n(12),n(4)),u=n(0),l=a.a.createContext({showHex:!1,setShowHex:function(){}}),h=function(){return Object(i.useContext)(l)},d=function(e){var t=e.children,n=Object(i.useState)(!1),r=Object(s.a)(n,2),a={showHex:r[0],setShowHex:r[1]};return Object(u.jsx)(l.Provider,{value:a,children:t})},g=n(10),b=n.n(g),f=n(13),p=n(6),j=n(2),m=n.n(j),w=function(e){var t,n=m.a.sumBy(e,(function(e){return e.byteLength})),r=new Uint8Array(n),i=0,a=Object(p.a)(e);try{for(a.s();!(t=a.n()).done;){var c=t.value;r.set(new Uint8Array(c),i),i+=c.byteLength}}catch(o){a.e(o)}finally{a.f()}return r.buffer},O=n(5),y=n(9),S=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Array.from(new Uint8Array(e)).map(x).join(t?" ":"")},x=function(e){return("0"+e.toString(16)).slice(-2)},v=function(){function e(t){var n=this;Object(O.a)(this,e),this.dataWindow=t,this.getSegmentSize=function(e){return n.dataWindow.getByte(27+e)},this.getSegment=function(e){return n.segments[e]}}return Object(y.a)(e,[{key:"capturePattern",get:function(){return(new TextDecoder).decode(this.dataWindow.getArrayBufferSlice(0,4))}},{key:"version",get:function(){return this.dataWindow.getByte(4)}},{key:"headerType",get:function(){return this.dataWindow.getByte(5)}},{key:"containsContinuedPacket",get:function(){return!!(1&this.headerType)}},{key:"isFirstPage",get:function(){return!!(2&this.headerType)}},{key:"isLastPage",get:function(){return!!(4&this.headerType)}},{key:"granulePosition",get:function(){return this.dataWindow.getBigInt64(6)}},{key:"bitstreamSerialNumber",get:function(){return S(this.dataWindow.getArrayBufferSlice(14,4))}},{key:"pageSequenceNumber",get:function(){return this.dataWindow.getInt32(18)}},{key:"crcChecksum",get:function(){return S(this.dataWindow.getArrayBufferSlice(22,4))}},{key:"numberOfPageSegments",get:function(){return this.dataWindow.getByte(26)}},{key:"segmentSizes",get:function(){return m.a.range(this.numberOfPageSegments).map(this.getSegmentSize)}},{key:"segments",get:function(){for(var e=this.headerSize,t=[],n=0;n<this.numberOfPageSegments;n++){var r=this.getSegmentSize(n),i=this.dataWindow.getArrayBufferSlice(e,r);t.push(i),e+=r}return t}},{key:"headerSize",get:function(){return 27+this.numberOfPageSegments}},{key:"pageSize",get:function(){return this.headerSize+m.a.sum(this.segmentSizes)}}]),e}(),k=function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(O.a)(this,e),this.bytes=void 0,this.dataView=void 0,this.offset=void 0,this.getByte=function(e){return n.bytes[e+n.offset]},this.getBigInt64=function(e){return n.dataView.getBigInt64(e+n.offset,!0)},this.getInt16=function(e){return n.dataView.getInt16(e+n.offset,!0)},this.getInt32=function(e){return n.dataView.getInt32(e+n.offset,!0)},this.getUint32=function(e){return n.dataView.getUint32(e+n.offset,!0)},this.getUint16=function(e){return n.dataView.getUint16(e+n.offset,!0)},this.getUint8=function(e){return n.dataView.getUint8(e+n.offset)},this.getArrayBufferSlice=function(e,t){return n.bytes.slice(n.offset+e,n.offset+e+t).buffer},this.slide=function(t){return new e(n.bytes.buffer,n.offset+t)},this.bytes=new Uint8Array(t),this.dataView=new DataView(t),this.offset=r},P=[79,112,117,115,72,101,97,100],N=[128,116,104,101,111,114,97],L=[1,118,111,114,98,105,115],B=[102,105,115,104,101,97,100,0],H=function(e,t){return m.a.isEqual(function(e,t){return Array.from(new Uint8Array(e.slice(0,Math.min(t,e.byteLength))))}(e,t.length),t)},_=function(e){if(0!==e.packets.length){var t=e.packets[0];return H(t,P)?"opus":H(t,N)?"theora":H(t,L)?"vorbis":H(t,B)?"ogg-skeleton":void 0}},C=n(14),W=n(19),A=function(e){var t=e.onDrop,n=Object(i.useCallback)((function(e){return t(e[0])}),[t]),r=Object(W.a)({onDropAccepted:n,accept:["audio/ogg","video/ogg","application/ogg","audio/opus"]}),a=r.getRootProps,c=r.getInputProps;return Object(u.jsxs)("div",Object(C.a)(Object(C.a)({className:"dropzone"},a()),{},{children:[Object(u.jsx)("input",Object(C.a)({},c())),"Click here or drop an Ogg file to upload"]}))},F=n(7),T=n(16),I=n.n(T);!function(e){e.SINGLE="SINGLE",e.MULTIPLE="MULTIPLE"}(r||(r={}));var G,E=function(e){return{type:r.SINGLE,label:e}},U=function(e){return{type:r.MULTIPLE,labels:e}},z=function(e){var t=e.dataWindow,n=e.showHex,r=e.rows;return Object(u.jsx)("table",{className:"byte-table",children:Object(u.jsx)("tbody",{children:r.map((function(e,r){var i=4*r,a=i+m.a.sumBy(e.cells,(function(e){return e.width}))-1,c=m.a.range(i,a+1).map((function(e){return x(t.getByte(e))}));return Object(u.jsx)(M,{showHex:n,rowSpec:e,startByte:i,endByte:a,hex:c},"byte-table-row-".concat(r))}))})})},M=function(e){var t=e.startByte,n=e.endByte,i=e.showHex,a=e.rowSpec,c=e.hex,o=a.cells,s=function(e,t){return c[m.a.sumBy(m.a.take(o,e),(function(e){return e.width}))+t]};return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("tr",{children:[Object(u.jsxs)("th",{className:"byte-table__byte-header-cell",rowSpan:i?3:2,children:[t,"-",n]}),o.map((function(e,t){var n;return Object(u.jsx)("td",{className:"byte-table__header-cell byte-table__cell-style-".concat(e.colour," byte-table__border-right"),colSpan:e.width,children:null!==(n=e.header)&&void 0!==n?n:Object(u.jsx)(u.Fragment,{children:"\xa0"})},"byte-table-header-row-".concat(t))}))]}),i&&Object(u.jsx)("tr",{children:o.map((function(e,t){return m.a.range(e.width).map((function(n){return Object(u.jsx)("td",{className:I()("byte-table__hex-cell","byte-table__cell-style-".concat(e.colour),{"byte-table__border-right":n===e.width-1}),children:s(t,n)},"byte-table-hex-row-".concat(t,"-").concat(n))}))}))}),Object(u.jsx)("tr",{className:"byte-table-row3",children:o.map((function(e,t){var n,i,a;return(null===(n=e.interpretation)||void 0===n?void 0:n.type)===r.MULTIPLE?e.interpretation.labels.map((function(n,r){return Object(u.jsx)("td",{className:I()("byte-table__interpretation-cell","byte-table__cell-style-".concat(e.colour),{"byte-table__border-right":r===e.width-1}),children:n},"byte-table-interpretation-".concat(t,"-").concat(r))})):Object(u.jsx)("td",{className:"byte-table__interpretation-cell byte-table__cell-style-".concat(e.colour," byte-table__border-right"),colSpan:e.width,children:null!==(i=null===(a=e.interpretation)||void 0===a?void 0:a.label)&&void 0!==i?i:Object(u.jsx)(u.Fragment,{children:"\xa0"})},"byte-table-interpretation-".concat(t))}))})]})},R=function(e){var t=[];return e.containsContinuedPacket&&t.push("Contains continued packet"),e.isFirstPage&&t.push("First page"),e.isLastPage&&t.push("Last page"),t.join(", ")},V=function(e){var t=e.page,n=e.showHex,r=[{cells:[{width:4,colour:1,header:"Capture Pattern",interpretation:U(m.a.range(4).map((function(e){return t.capturePattern[e]})))}]},{cells:[{width:1,colour:2,header:"Version",interpretation:E(t.version.toString())},{width:1,colour:3,header:"Header Type",interpretation:E(R(t))},{width:2,colour:4}]},{cells:[{width:4,colour:4,header:"Granule Position",interpretation:E(t.granulePosition.toString())}]},{cells:[{width:2,colour:4},{width:2,colour:5,header:"Bitstream Serial Number",interpretation:E(t.bitstreamSerialNumber)}]},{cells:[{width:2,colour:5},{width:2,colour:6,header:"Page Sequence Number",interpretation:E(t.pageSequenceNumber.toString())}]},{cells:[{width:2,colour:6},{width:2,colour:7,header:"CRC Checksum",interpretation:E(t.crcChecksum)}]},{cells:[{width:2,colour:7},{width:1,colour:8,header:"Page Segments",interpretation:E(t.numberOfPageSegments.toString())}].concat(Object(F.a)(0===t.numberOfPageSegments?[]:[{width:1,colour:9,header:"Segment 1 Size",interpretation:E(t.getSegmentSize(0).toString())}]))}].concat(Object(F.a)(D(t)));return Object(u.jsx)(z,{dataWindow:t.dataWindow,showHex:n,rows:r})},D=function(e){return m.a.chunk(m.a.range(1,e.numberOfPageSegments),4).map((function(t){return{cells:t.map((function(t){return{width:1,colour:9,header:"Segment ".concat(t+1," size"),interpretation:E(e.getSegmentSize(t).toString())}}))}}))},q=function(e){return!(e.byteLength<8)&&"OpusTags"===(new TextDecoder).decode(e.slice(0,8))},J=function(){function e(t){Object(O.a)(this,e),this.dataWindow=t}return Object(y.a)(e,[{key:"magicSignature",get:function(){return(new TextDecoder).decode(this.dataWindow.getArrayBufferSlice(0,8))}},{key:"vendorStringLength",get:function(){return this.dataWindow.getUint32(8)}},{key:"vendorString",get:function(){return(new TextDecoder).decode(this.dataWindow.getArrayBufferSlice(12,this.vendorStringLength))}},{key:"userCommentListLength",get:function(){return this.dataWindow.getUint32(12+this.vendorStringLength)}}]),e}(),K=function(e){return!(e.byteLength<8)&&"OpusHead"===(new TextDecoder).decode(e.slice(0,8))},Q=function(){function e(t){Object(O.a)(this,e),this.dataWindow=t}return Object(y.a)(e,[{key:"magicSignature",get:function(){return(new TextDecoder).decode(this.dataWindow.getArrayBufferSlice(0,8))}},{key:"version",get:function(){return this.dataWindow.getUint8(8)}},{key:"channelCount",get:function(){return this.dataWindow.getUint8(9)}},{key:"preSkip",get:function(){return this.dataWindow.getUint16(10)}},{key:"inputSampleRate",get:function(){return this.dataWindow.getUint32(12)}},{key:"outputGain",get:function(){return this.dataWindow.getInt16(16)}},{key:"channelMappingFamily",get:function(){return this.dataWindow.getUint8(18)}}]),e}(),X=function(e){var t=e.header,n=e.showHex,r=[{cells:[{width:4,colour:1,header:"Magic Signature",interpretation:U(m.a.range(4).map((function(e){return t.magicSignature[e]})))}]},{cells:[{width:4,colour:1,interpretation:U(m.a.range(4,8).map((function(e){return t.magicSignature[e]})))}]}].concat(Object(F.a)(function(e,t){var n,r=[],i=[],a=function(){return m.a.sumBy(i,(function(e){return e.width}))},c=Object(p.a)(e);try{var o=function(){var e=n.value,c=t-a();if(e.width<=c)i.push(e),a()===t&&(r.push({cells:[].concat(i)}),i.length=0);else{var o={colour:e.colour,width:c,header:e.header,interpretation:e.interpretation};i.push(o),r.push({cells:[].concat(i)}),i.length=0;var s=e.width-o.width,u=Math.floor(s/t),l=m.a.range(u).map((function(n){return{cells:[{colour:e.colour,width:t}]}}));r.push.apply(r,Object(F.a)(l));var h=s%t;if(h>0){var d={colour:e.colour,width:h};i.push(d)}}};for(c.s();!(n=c.n()).done;)o()}catch(s){c.e(s)}finally{c.f()}return i.length>0&&(r.push({cells:[].concat(i)}),i.length=0),r}([{width:4,colour:2,header:"Vendor String Length",interpretation:E(t.vendorStringLength.toString())},{width:t.vendorString.length,colour:3,header:"Vendor String",interpretation:E(t.vendorString)},{width:4,colour:4,header:"User Comment List Length",interpretation:E(t.userCommentListLength.toString())}],4)));return Object(u.jsx)(z,{dataWindow:t.dataWindow,showHex:n,rows:r})},Y=function(e){var t=e.header,n=e.showHex,r=[{cells:[{width:4,colour:1,header:"Magic Signature",interpretation:U(m.a.range(4).map((function(e){return t.magicSignature[e]})))}]},{cells:[{width:4,colour:1,interpretation:U(m.a.range(4,8).map((function(e){return t.magicSignature[e]})))}]},{cells:[{width:1,colour:2,header:"Version",interpretation:E(t.version.toString())},{width:1,colour:3,header:"Channel Count",interpretation:E(t.channelCount.toString())},{width:2,colour:4,header:"Pre-skip",interpretation:E(t.preSkip.toString())}]},{cells:[{width:4,colour:5,header:"Input Sample Rate",interpretation:E(t.inputSampleRate.toString())}]},{cells:[{width:2,colour:6,header:"Output Gain",interpretation:E(t.outputGain.toString())},{width:1,colour:7,header:"Mapping Family",interpretation:E(t.channelMappingFamily.toString())}]}];return Object(u.jsx)(z,{dataWindow:t.dataWindow,showHex:n,rows:r})},Z=function(e){return!K(e)&&!q(e)},$=function(e){var t=e.packets,n=e.showHex;return Object(u.jsx)(u.Fragment,{children:t.map((function(e,t){return Object(u.jsxs)(a.a.Fragment,{children:[Z(e)&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("h3",{children:["Packet ",t+1," (",e.byteLength," bytes)"]}),n&&Object(u.jsx)("div",{className:"raw-hex",children:S(e,!0)},"packet-hex-".concat(t))]}),K(e)&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("h3",{children:["Packet ",t+1," (",e.byteLength," bytes) - Ogg Opus Identification Header"]}),Object(u.jsx)("p",{children:Object(u.jsx)("a",{className:"rfc-link",href:"https://datatracker.ietf.org/doc/html/rfc7845#section-5.1",children:"RFC 7845 - 5.1. Identification Header"})}),Object(u.jsx)(Y,{header:new Q(new k(e)),showHex:n}),Object(u.jsx)("p",{})]}),q(e)&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("h3",{children:["Packet ",t+1," (",e.byteLength," bytes) - Ogg Opus Comment Header"]}),Object(u.jsx)("p",{children:Object(u.jsx)("a",{className:"rfc-link",href:"https://datatracker.ietf.org/doc/html/rfc7845#section-5.2",children:"RFC 7845 - 5.2. Comment Header"})}),Object(u.jsx)(X,{header:new J(new k(e)),showHex:n}),Object(u.jsx)("p",{})]})]},"packet-".concat(t))}))})},ee=function(e){var t,n,r=e.oggPages,a=h().showHex,c=Object(i.useState)(0),o=Object(s.a)(c,2),l=o[0],d=o[1];Object(i.useEffect)((function(){return d(0)}),[r]);var g=l<r.length?r[l]:void 0,b=void 0===g?[]:function(e){var t,n=[],r=[],i=!0,a=Object(p.a)(e.segments);try{for(a.s();!(t=a.n()).done;){var c=t.value;if(r.push(c),c.byteLength<255){var o=w(r);e.containsContinuedPacket&&i||n.push(o),r.length=0,i=!1}}}catch(s){a.e(s)}finally{a.f()}return n}(g);return Object(u.jsxs)("div",{className:"ogg-pages-tab",children:[Object(u.jsxs)("h1",{children:["Ogg Page ",l+1," / ",r.length," (",null!==(t=null===g||void 0===g?void 0:g.pageSize)&&void 0!==t?t:0," bytes)"]}),Object(u.jsx)("button",{onClick:function(){return d(l-1)},disabled:0===l,children:"Previous"}),Object(u.jsx)("button",{onClick:function(){return d(l+1)},disabled:l>=(null!==(n=null===r||void 0===r?void 0:r.length)&&void 0!==n?n:0)-1,children:"Next"}),Object(u.jsx)("h2",{children:"Ogg Page Header"}),g&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("p",{children:Object(u.jsx)("a",{className:"rfc-link",href:"https://datatracker.ietf.org/doc/html/rfc3533#section-6",children:"RFC 3533 - 6. The Ogg page format"})}),Object(u.jsx)(V,{page:g,showHex:a}),Object(u.jsx)("h2",{children:"Ogg Packets"}),Object(u.jsx)($,{packets:b,showHex:a}),Object(u.jsx)("h2",{children:"Segments"}),m.a.range(0,g.numberOfPageSegments).map((function(e){return Object(u.jsx)(te,{number:e+1,size:g.getSegmentSize(e),hex:a?S(g.getSegment(e),!0):void 0},"segment-".concat(e))}))]})]})},te=function(e){var t=e.number,n=e.size,r=e.hex;return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("h3",{children:["Segment ",t," (",n," bytes)"]}),r&&Object(u.jsx)("div",{className:"raw-hex",children:r})]})},ne=function(e){var t=e.streams,n=h().showHex,r=Object(i.useState)(t[0].serialNumber),a=Object(s.a)(r,2),c=a[0],o=a[1];Object(i.useEffect)((function(){return o(t[0].serialNumber)}),[t]);var l=t.find((function(e){return e.serialNumber===c}));return void 0===l?Object(u.jsx)(u.Fragment,{}):Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{children:"Logical Bitstreams"}),t.map((function(e){return Object(u.jsxs)("div",{children:[Object(u.jsx)("input",{type:"radio",id:e.serialNumber,name:e.serialNumber,value:e.serialNumber,checked:e.serialNumber===c,onChange:function(){return o(e.serialNumber)}}),Object(u.jsxs)("label",{htmlFor:e.serialNumber,children:[Object(u.jsx)("span",{className:"bitstream-serial-number-radio-label",children:e.serialNumber})," -"," ",_(e)," - ",e.packets.length," packets -"," ",m.a.sumBy(e.packets,(function(e){return e.byteLength}))," bytes"]})]},e.serialNumber)})),Object(u.jsx)("h2",{children:"Ogg Packets"}),Object(u.jsx)($,{packets:l.packets,showHex:n})]})},re=function(){var e=Object(f.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.next=5,n.blob();case 5:return r=e.sent,e.next=8,r.arrayBuffer();case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie="".concat("/ogg-toe-puss","/example_0.opus");!function(e){e.OGG_PAGES="OGG_PAGES",e.BITSTREAMS="BITSTREAMS"}(G||(G={}));var ae=function(){var e=Object(i.useState)(),t=Object(s.a)(e,2),n=t[0],r=t[1],a=Object(i.useState)([]),c=Object(s.a)(a,2),o=c[0],l=c[1],d=Object(i.useState)(G.OGG_PAGES),g=Object(s.a)(d,2),j=g[0],m=g[1],O=h(),y=O.showHex,S=O.setShowHex,x=function(e){var t=function(e){for(var t=new k(e),n=new v(t),r=[n];!n.isLastPage;)t=t.slide(n.pageSize),n=new v(t),r.push(n);return r}(e),n=function(e){var t,n=new Map,r=[],i=Object(p.a)(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;a.isFirstPage&&n.set(a.bitstreamSerialNumber,{packets:[],segmentsSoFar:[]});var c=n.get(a.bitstreamSerialNumber);if(void 0===c)throw Error("Unexpected page for bitstream with serial number ".concat(a.bitstreamSerialNumber));var o,u=Object(p.a)(a.segments);try{for(u.s();!(o=u.n()).done;){var l=o.value;if(c.segmentsSoFar.push(l),l.byteLength<255){var h=w(c.segmentsSoFar);c.packets.push(h),c.segmentsSoFar.length=0}}}catch(m){u.e(m)}finally{u.f()}a.isLastPage&&(r.push({serialNumber:a.bitstreamSerialNumber,packets:c.packets}),n.delete(a.bitstreamSerialNumber))}}catch(m){i.e(m)}finally{i.f()}var d,g=Object(p.a)(n);try{for(g.s();!(d=g.n()).done;){var b=Object(s.a)(d.value,2),f=b[0],j=b[1];r.push({serialNumber:f,packets:j.packets})}}catch(m){g.e(m)}finally{g.f()}return r}(t);r(t),l(n)};return Object(i.useEffect)((function(){re(ie).then(x)}),[]),Object(u.jsxs)("div",{className:"app",children:[Object(u.jsx)("button",{onClick:function(){return m(G.OGG_PAGES)},disabled:j===G.OGG_PAGES,children:"Ogg Pages"}),Object(u.jsx)("button",{onClick:function(){return m(G.BITSTREAMS)},disabled:j===G.BITSTREAMS,children:"Logical Bitstreams"}),Object(u.jsxs)("div",{className:"show-hex-checkbox",children:[Object(u.jsx)("label",{htmlFor:"showHex",children:"Show Hex"}),Object(u.jsx)("input",{id:"showHex",onChange:function(){return S(!y)},checked:y,type:"checkbox"})]}),Object(u.jsx)(A,{onDrop:function(){var e=Object(f.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=x,e.next=3,t.arrayBuffer();case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),j===G.OGG_PAGES&&Object(u.jsx)(ee,{oggPages:null!==n&&void 0!==n?n:[]}),j===G.BITSTREAMS&&Object(u.jsx)(ne,{streams:o})]})},ce=function(){return Object(u.jsx)(d,{children:Object(u.jsx)(ae,{})})};n(30);o.a.render(Object(u.jsx)(a.a.StrictMode,{children:Object(u.jsx)(ce,{})}),document.getElementById("root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.0df4bad3.chunk.js.map